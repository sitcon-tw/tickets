---
title: 環境變數對照
description: 前後端常用環境變數與用途
---

## 共用

| 變數           | 預設                    | 用途                                            |
| -------------- | ----------------------- | ----------------------------------------------- |
| `NODE_ENV`     | `development`           | 控制 Fastify logger、Redis 客戶端建立方式等     |
| `FRONTEND_URI` | `http://localhost:4322` | 郵件連結、CORS 白名單、Magic Link redirect 使用 |
| `BACKEND_URI`  | `http://localhost:3000` | 前端 proxy、BetterAuth base URL、Email 模板     |
| `PORT`         | `3000`                  | Fastify 監聽埠                                  |

## 後端 (`backend/.env`)

| 變數                          | 預設/說明                                                             |
| ----------------------------- | --------------------------------------------------------------------- | ---------------------------- |
| `POSTGRES_URI`                | **必填**，Prisma 連線字串，例如 `postgresql://user:pass@host:5432/db` |
| `BETTER_AUTH_SECRET`          | **必填**，32 字元以上，提供 Magic Link token 簽章                     |
| `ADMIN_EMAILS`                | 以逗號分隔，登入時自動授予 `admin` 角色                               |
| `MAILTRAP_TOKEN`              | **必填**，Mailtrap API Token                                          |
| `MAILTRAP_SENDER_EMAIL`       | 寄件人信箱，例如 `noreply@sitcon.org`                                 |
| `MAIL_FROM_NAME`              | 寄件者顯示名稱（預設 `SITCONTIX`）                                    |
| `REDIS_URI`                   | Redis 連線字串，不設定則停用 Prisma 快取但仍可運作                    |
| `REDIS_DEBUG`                 | `true/false`，開啟後列印快取 log                                      |
| `RATE_LIMIT_MAX`              | `30000`                                                               | 全域速率限制上限             |
| `RATE_LIMIT_WINDOW`           | `10 minutes`                                                          | 全域速率限制時間窗           |
| `AUTH_RATE_LIMIT_MAX`         | `20000`                                                               | `/api/auth/*` 速率限制上限   |
| `MAX_BODY_SIZE`               | `1048576`                                                             | Fastify `bodyLimit`（bytes） |
| `MAX_JSON_SIZE`               | `524288`                                                              | JSON payload 限制（bytes）   |
| `OTEL_EXPORTER_OTLP_ENDPOINT` | `http://tempo:4318/v1/traces`                                         | OpenTelemetry OTLP HTTP 端點 |
| `MAILTRAP_TEMPLATE_ID`        | 如有使用 Mailtrap template 可於程式內引用                             |

## 前端 (`frontend/.env`)

| 變數            | 預設/說明                                                             |
| --------------- | --------------------------------------------------------------------- |
| `BACKEND_URI`   | `http://localhost:3000`，透過 `next.config.ts` rewrites `/api`        |
| `SITE`          | `https://ticket.sitcon.org`，用於產生 `generateMetadata` 內的完整網址 |
| `NEXT_PUBLIC_*` | 目前未使用；若新增公開設定請以 `NEXT_PUBLIC_` 前綴                    |

## 監控/部署

| 變數                          | 說明                                              |
| ----------------------------- | ------------------------------------------------- |
| `OTEL_EXPORTER_OTLP_ENDPOINT` | 設定 Tempo / OTEL Collector URL                   |
| `PUBLIC_DOMAIN`               | Zeabur `grafana.yaml` 模板使用，指定 Grafana 網域 |

> 建議於專案根目錄新增 `.env.example`，同步維護上述鍵值與描述，便於新進成員設定環境。
